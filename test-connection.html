<!DOCTYPE html>
<html>
<head>
    <title>Prueba de ConexiÃ³n - ESPE Pageant</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .success { color: green; }
        .error { color: red; }
        .info { color: blue; }
        .test-result { margin: 10px 0; padding: 10px; border: 1px solid #ccc; }
    </style>
</head>
<body>
    <h1>ðŸ§ª Prueba de ConexiÃ³n ESPE Pageant</h1>
    
    <div id="results"></div>
    
    <script>
        const resultsDiv = document.getElementById('results');
        
        function addResult(title, message, type = 'info') {
            const div = document.createElement('div');
            div.className = `test-result ${type}`;
            div.innerHTML = `<strong>${title}:</strong> ${message}`;
            resultsDiv.appendChild(div);
        }
        
        async function testConnection() {
            addResult('ðŸ”„ Iniciando', 'Pruebas de conexiÃ³n...', 'info');
            
            try {
                // Test 1: Health check
                addResult('ðŸ¥ Health Check', 'Probando...', 'info');
                const healthResponse = await fetch('http://localhost:3000/health');
                if (healthResponse.ok) {
                    const healthData = await healthResponse.json();
                    addResult('ðŸ¥ Health Check', `âœ… Servidor funcionando: ${healthData.message}`, 'success');
                } else {
                    addResult('ðŸ¥ Health Check', `âŒ Error: ${healthResponse.status}`, 'error');
                }
                
                // Test 2: Database connection
                addResult('ðŸ—„ï¸ Base de Datos', 'Probando...', 'info');
                const dbResponse = await fetch('http://localhost:3000/api/test-db');
                if (dbResponse.ok) {
                    const dbData = await dbResponse.json();
                    addResult('ðŸ—„ï¸ Base de Datos', `âœ… ${dbData.message} - Hora: ${dbData.data.current_time}`, 'success');
                } else {
                    addResult('ðŸ—„ï¸ Base de Datos', `âŒ Error: ${dbResponse.status}`, 'error');
                }
                
                // Test 3: Events endpoint
                addResult('ðŸ“… Eventos', 'Probando...', 'info');
                const eventsResponse = await fetch('http://localhost:3000/api/events');
                if (eventsResponse.ok) {
                    const eventsData = await eventsResponse.json();
                    addResult('ðŸ“… Eventos', `âœ… ${eventsData.data.length} eventos encontrados`, 'success');
                } else {
                    addResult('ðŸ“… Eventos', `âŒ Error: ${eventsResponse.status}`, 'error');
                }
                
                // Test 4: Candidates endpoint
                addResult('ðŸ‘¸ Candidatas', 'Probando...', 'info');
                const candidatesResponse = await fetch('http://localhost:3000/api/candidates');
                if (candidatesResponse.ok) {
                    const candidatesData = await candidatesResponse.json();
                    addResult('ðŸ‘¸ Candidatas', `âœ… ${candidatesData.data.length} candidatas encontradas`, 'success');
                } else {
                    addResult('ðŸ‘¸ Candidatas', `âŒ Error: ${candidatesResponse.status}`, 'error');
                }
                
                // Test 5: CORS
                addResult('ðŸ”— CORS', 'Verificado - Las peticiones desde este puerto funcionan', 'success');
                
                addResult('ðŸŽŠ Resultado Final', 'Todas las conexiones estÃ¡n funcionando correctamente!', 'success');
                
            } catch (error) {
                addResult('âŒ Error Fatal', `No se puede conectar al servidor: ${error.message}`, 'error');
                addResult('ðŸ’¡ Sugerencia', 'Verifica que el servidor estÃ© ejecutÃ¡ndose en http://localhost:3000', 'info');
            }
        }
        
        // Ejecutar pruebas al cargar la pÃ¡gina
        testConnection();
        
        // BotÃ³n para volver a ejecutar
        const button = document.createElement('button');
        button.textContent = 'ðŸ”„ Ejecutar Pruebas Nuevamente';
        button.style.marginTop = '20px';
        button.style.padding = '10px 20px';
        button.style.fontSize = '16px';
        button.onclick = () => {
            resultsDiv.innerHTML = '';
            testConnection();
        };
        document.body.appendChild(button);
    </script>
</body>
</html> 